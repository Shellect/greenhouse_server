# üçì Strawberry Greenhouse Server

–£–º–Ω–∞—è —Ç–µ–ø–ª–∏—Ü–∞ –¥–ª—è –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è –∫–ª—É–±–Ω–∏–∫–∏ –Ω–∞ –±–∞–∑–µ NodeMCU ESP8266.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —É—Å–ª–æ–≤–∏–π –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è –∫–ª—É–±–Ω–∏–∫–∏:

- **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** —Å –¥–∞—Ç—á–∏–∫–æ–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã, –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–¥—É—Ö–∞ –∏ –ø–æ—á–≤—ã, –æ—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –ø–æ–ª–∏–≤–æ–º, –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–µ–π, –æ–±–æ–≥—Ä–µ–≤–æ–º, –æ—Å–≤–µ—â–µ–Ω–∏–µ–º
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–£–º–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è** –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç –Ω–æ—Ä–º—ã
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è** –ø–æ–¥ —Å—Ç–∞–¥–∏—é —Ä–æ—Å—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π

## üå± –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–ª—É–±–Ω–∏–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä          | –î–µ–Ω—å        | –ù–æ—á—å    | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ      |
|-------------------|-------------|---------|------------------|
| –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞       | 18-25¬∞C     | 15-18¬∞C | <5¬∞C / >35¬∞C     |
| –í–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞ | 60-75%      | 60-75%  | <40% / >90%      |
| –í–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã   | 60-80%      | 60-80%  | <40% / >95%      |
| –û—Å–≤–µ—â–µ–Ω–∏–µ         | 200-600 lux | -       | 12-16 —á–∞—Å–æ–≤/–¥–µ–Ω—å |
| pH –ø–æ—á–≤—ã          | 5.5-6.8     | 5.5-6.8 | -                |

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- NodeMCU ESP8266
- –î–∞—Ç—á–∏–∫–∏: DHT22, –¥–∞—Ç—á–∏–∫ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –ø–æ—á–≤—ã
- –†–µ–ª–µ –º–æ–¥—É–ª—å (4-6 –∫–∞–Ω–∞–ª–æ–≤)

### –°–µ—Ä–≤–µ—Ä

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
cd greenhouse

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏: venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python main.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8000`

### NodeMCU

1. –û—Ç–∫—Ä–æ–π—Ç–µ `nodemcu/greenhouse_controller.ino` –≤ Arduino IDE
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
   - ESP8266WiFi
   - ArduinoJson
   - DHT sensor library
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ WiFi –∏ IP —Å–µ—Ä–≤–µ—Ä–∞ –≤ –∫–æ–¥–µ
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É –Ω–∞ NodeMCU

## üì° API Endpoints

### –î–∞—Ç—á–∏–∫–∏

| –ú–µ—Ç–æ–¥ | Endpoint                           | –û–ø–∏—Å–∞–Ω–∏–µ                   |
|-------|------------------------------------|----------------------------|
| POST  | `/api/v1/sensors/data`             | –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–∞—Ç—á–∏–∫–æ–≤ |
| GET   | `/api/v1/sensors/latest`           | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è        |
| GET   | `/api/v1/sensors/history?hours=24` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π          |
| GET   | `/api/v1/sensors/stats?hours=24`   | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞                 |

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –ú–µ—Ç–æ–¥ | Endpoint                           | –û–ø–∏—Å–∞–Ω–∏–µ                     |
|-------|------------------------------------|------------------------------|
| GET   | `/api/v1/devices`                  | –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤             |
| POST  | `/api/v1/devices/command`          | –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã             |
| POST  | `/api/v1/devices/{type}/auto`      | –í–∫–ª/–≤—ã–∫–ª –∞–≤—Ç–æ—Ä–µ–∂–∏–º           |
| GET   | `/api/v1/devices/commands/pending` | –û—á–µ—Ä–µ–¥—å –∫–æ–º–∞–Ω–¥ (–¥–ª—è NodeMCU) |

### –°—Ç–∞—Ç—É—Å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

| –ú–µ—Ç–æ–¥ | Endpoint                     | –û–ø–∏—Å–∞–Ω–∏–µ              |
|-------|------------------------------|-----------------------|
| GET   | `/api/v1/status`             | –ü–æ–ª–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Ç–µ–ø–ª–∏—Ü—ã |
| POST  | `/api/v1/control/settings`   | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è    |
| GET   | `/api/v1/control/parameters` | –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |

### –û–ø–æ–≤–µ—â–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | Endpoint                          | –û–ø–∏—Å–∞–Ω–∏–µ               |
|-------|-----------------------------------|------------------------|
| GET   | `/api/v1/alerts`                  | –ê–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è    |
| POST  | `/api/v1/alerts/{id}/acknowledge` | –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ |

## üìä –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å NodeMCU –ø–æ –∞–¥—Ä–µ—Å—É POST /api/v1/sensors/data

```json
{
    "temperature": 22.5,
    "humidity": 65.0,
    "soil_moisture": 70.0,
    "light_level": 400,
    "device_id": "nodemcu-1"
}
```

–û—Ç–≤–µ—Ç:
```json
{
    "status": "ok",
    "reading_id": 123,
    "timestamp": "2024-01-15T12:30:00",
    "commands": [
        {"device": "pump", "action": "off", "duration": null},
        {"device": "fan", "action": "on", "duration": null}
    ],
    "health_score": 85.5,
    "is_daytime": true
}
```

## üîå –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è NodeMCU

```
NodeMCU          –ö–æ–º–ø–æ–Ω–µ–Ω—Ç
-------          ---------
D4     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ DHT22 Data
A0     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Soil Moisture Sensor
D1     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay 1 (Pump)
D2     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay 2 (Fan)
D5     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay 3 (Heater)
D6     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay 4 (Light)
D7     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay 5 (Humidifier)
D8     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay 6 (Cooler)
3.3V   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ DHT22 VCC
GND    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Common GND
5V     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Relay VCC
```

## üåø –°—Ç–∞–¥–∏–∏ —Ä–æ—Å—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ —Ç–µ–∫—É—â—É—é —Å—Ç–∞–¥–∏—é:

1. **üå± –†–∞—Å—Å–∞–¥–∞ (Seedling)** ‚Äî –≤—ã—Å–æ–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —É–º–µ—Ä–µ–Ω–Ω—ã–π —Å–≤–µ—Ç
2. **üåø –í–µ–≥–µ—Ç–∞—Ü–∏—è (Vegetative)** ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–π —Ä–æ—Å—Ç, –∞–∑–æ—Ç–Ω—ã–µ –ø–æ–¥–∫–æ—Ä–º–∫–∏
3. **üå∏ –¶–≤–µ—Ç–µ–Ω–∏–µ (Flowering)** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–ª–∞–∂–Ω–æ—Å—Ç–∏, –æ–ø—ã–ª–µ–Ω–∏–µ
4. **üçì –ü–ª–æ–¥–æ–Ω–æ—à–µ–Ω–∏–µ (Fruiting)** ‚Äî —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –ø–æ–ª–∏–≤, –∫–∞–ª–∏–π
5. **‚ùÑÔ∏è –ü–æ–∫–æ–π (Dormant)** ‚Äî —Å–Ω–∏–∂–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –ø–æ–ª–∏–≤–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
greenhouse/
‚îú‚îÄ‚îÄ main.py              # FastAPI —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚îú‚îÄ‚îÄ models.py            # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ database.py          # –†–∞–±–æ—Ç–∞ —Å SQLite
‚îú‚îÄ‚îÄ controller.py        # –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ greenhouse.db        # SQLite –±–∞–∑–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ nodemcu/
‚îÇ   ‚îî‚îÄ‚îÄ greenhouse_controller.ino  # –ü—Ä–æ—à–∏–≤–∫–∞ NodeMCU
‚îî‚îÄ‚îÄ README.md
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config.py` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–ª—É–±–Ω–∏–∫–∏
- –í—Ä–µ–º—è –¥–Ω—è/–Ω–æ—á–∏
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:

```env
DATABASE_URL=sqlite+aiosqlite:///./greenhouse.db
DEBUG=True
SECRET_KEY=your-secret-key
```

## üìà –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8000` –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

- –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤
- –û—Ü–µ–Ω–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Ä–∞—Å—Ç–µ–Ω–∏–π (Health Score)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- –í—ã–±–æ—Ä —Å—Ç–∞–¥–∏–∏ —Ä–æ—Å—Ç–∞
- –ê–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Ö–æ–¥—É

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

---

üçì Happy Growing!





